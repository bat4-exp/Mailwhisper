<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice to Business Email Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .waveform {
            height: 60px;
            background: linear-gradient(90deg, #3b82f6, #9333ea);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        .waveform::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                90deg,
                rgba(255, 255, 255, 0.1),
                rgba(255, 255, 255, 0.1) 2px,
                transparent 2px,
                transparent 4px
            );
            animation: wave 1s linear infinite;
        }
        @keyframes wave {
            from { transform: translateX(-4px); }
            to { transform: translateX(0); }
        }
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">Voice to Business Email</h1>
            <p class="text-gray-600 max-w-2xl mx-auto">Record your thoughts and instantly transform them into professional business emails in multiple languages.</p>
        </header>

        <div class="flex flex-col lg:flex-row gap-6">
            <!-- Left Ad Space -->
            <div class="w-full lg:w-1/6 bg-gray-100 rounded-lg p-4 flex items-center justify-center">
                <div class="text-center text-gray-500">
                    <i class="fas fa-ad text-4xl mb-2"></i>
                    <p>Advertisement Space</p>
                </div>
            </div>

            <div class="flex-1">
                <div class="bg-white rounded-xl shadow-md overflow-hidden mb-6">
                    <div class="p-6">
                        <div class="flex flex-wrap gap-4 mb-6">
                            <div class="flex-1 min-w-[200px]">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Language</label>
                                <select id="language-select" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="en">English</option>
                                    <option value="es">Spanish</option>
                                    <option value="fr">French</option>
                                    <option value="de">German</option>
                                    <option value="it">Italian</option>
                                    <option value="pt">Portuguese</option>
                                    <option value="nl">Dutch</option>
                                    <option value="ja">Japanese</option>
                                    <option value="zh">Chinese</option>
                                    <option value="ru">Russian</option>
                                </select>
                            </div>
                            <div class="flex-1 min-w-[200px]">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Email Header</label>
                                <input type="text" id="email-header" placeholder="Optional header text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div class="flex-1 min-w-[200px]">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Email Footer</label>
                                <input type="text" id="email-footer" placeholder="Optional footer text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>

                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Jargon/Technical Terms (comma separated)</label>
                            <input type="text" id="jargon-terms" placeholder="e.g. API, SaaS, ROI, KPI" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                        </div>

                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-1">AI Creativity</label>
                            <div class="flex items-center gap-4">
                                <span class="text-sm text-gray-500">Precise</span>
                                <input type="range" id="creativity-slider" min="0" max="100" value="50" class="w-full slider-thumb">
                                <span class="text-sm text-gray-500">Creative</span>
                            </div>
                        </div>

                        <div class="flex flex-col sm:flex-row gap-4 mb-6">
                            <button id="record-btn" class="flex-1 bg-red-500 hover:bg-red-600 text-white font-medium py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center gap-2">
                                <i class="fas fa-microphone"></i> Start Recording
                            </button>
                            <button id="pause-btn" disabled class="flex-1 bg-yellow-500 hover:bg-yellow-600 text-white font-medium py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center gap-2">
                                <i class="fas fa-pause"></i> Pause
                            </button>
                            <button id="stop-btn" disabled class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center gap-2">
                                <i class="fas fa-stop"></i> Stop & Convert
                            </button>
                        </div>

                        <div id="recording-indicator" class="hidden mb-6">
                            <div class="waveform"></div>
                            <p class="text-sm text-gray-500 mt-2 flex items-center gap-2">
                                <span class="h-3 w-3 bg-red-500 rounded-full animate-pulse"></span>
                                <span id="recording-time">00:00</span>
                            </p>
                        </div>

                        <div class="mb-2 flex justify-between items-center">
                            <label class="block text-sm font-medium text-gray-700">Transcription / Email</label>
                            <button id="copy-btn" class="text-sm text-blue-600 hover:text-blue-800 hidden">
                                <i class="fas fa-copy mr-1"></i> Copy to Clipboard
                            </button>
                        </div>
                        <div class="relative">
                            <textarea id="transcription-text" rows="12" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Your transcription will appear here..."></textarea>
                            <div id="processing-indicator" class="absolute inset-0 bg-white bg-opacity-80 flex items-center justify-center hidden">
                                <div class="text-center">
                                    <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mx-auto mb-2"></div>
                                    <p class="text-gray-700">Converting to business email...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Ad Space -->
            <div class="w-full lg:w-1/6 bg-gray-100 rounded-lg p-4 flex items-center justify-center">
                <div class="text-center text-gray-500">
                    <i class="fas fa-ad text-4xl mb-2"></i>
                    <p>Advertisement Space</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const recordBtn = document.getElementById('record-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const stopBtn = document.getElementById('stop-btn');
        const copyBtn = document.getElementById('copy-btn');
        const transcriptionText = document.getElementById('transcription-text');
        const recordingIndicator = document.getElementById('recording-indicator');
        const recordingTime = document.getElementById('recording-time');
        const processingIndicator = document.getElementById('processing-indicator');
        const languageSelect = document.getElementById('language-select');
        const emailHeader = document.getElementById('email-header');
        const emailFooter = document.getElementById('email-footer');
        const jargonTerms = document.getElementById('jargon-terms');
        const creativitySlider = document.getElementById('creativity-slider');

        // Variables for recording
        let mediaRecorder;
        let audioChunks = [];
        let recordingStartTime;
        let recordingTimer;
        let isPaused = false;
        let pauseStartTime;
        let totalPausedTime = 0;
        let transcription = '';

        // Sample business email templates for different languages
        const emailTemplates = {
            en: {
                greeting: "Dear [Recipient],",
                closing: "Best regards,\n[Your Name]",
                style: "formal"
            },
            es: {
                greeting: "Estimado/a [Recipient],",
                closing: "Saludos cordiales,\n[Your Name]",
                style: "formal"
            },
            fr: {
                greeting: "Cher [Recipient],",
                closing: "Cordialement,\n[Your Name]",
                style: "formal"
            },
            de: {
                greeting: "Sehr geehrter [Recipient],",
                closing: "Mit freundlichen Grüßen,\n[Your Name]",
                style: "formal"
            },
            it: {
                greeting: "Egregio [Recipient],",
                closing: "Distinti saluti,\n[Your Name]",
                style: "formal"
            },
            pt: {
                greeting: "Prezado [Recipient],",
                closing: "Atenciosamente,\n[Your Name]",
                style: "formal"
            },
            nl: {
                greeting: "Geachte [Recipient],",
                closing: "Met vriendelijke groet,\n[Your Name]",
                style: "formal"
            },
            ja: {
                greeting: "[Recipient]様",
                closing: "敬具\n[Your Name]",
                style: "formal"
            },
            zh: {
                greeting: "尊敬的[Recipient]:",
                closing: "此致\n敬礼\n[Your Name]",
                style: "formal"
            },
            ru: {
                greeting: "Уважаемый [Recipient],",
                closing: "С уважением,\n[Your Name]",
                style: "formal"
            }
        };

        // Event Listeners
        recordBtn.addEventListener('click', startRecording);
        pauseBtn.addEventListener('click', togglePause);
        stopBtn.addEventListener('click', stopRecording);
        copyBtn.addEventListener('click', copyToClipboard);

        // Functions
        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                
                mediaRecorder.ondataavailable = event => {
                    audioChunks.push(event.data);
                };
                
                mediaRecorder.onstop = () => {
                    const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                    // In a real app, you would send this to a transcription API
                    simulateTranscription(audioBlob);
                };
                
                audioChunks = [];
                mediaRecorder.start(100); // Collect data every 100ms
                recordingStartTime = new Date();
                totalPausedTime = 0;
                startRecordingTimer();
                
                recordBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                recordingIndicator.classList.remove('hidden');
                
                recordBtn.classList.remove('bg-red-500', 'hover:bg-red-600');
                recordBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
            } catch (error) {
                console.error('Error accessing microphone:', error);
                alert('Could not access microphone. Please check permissions.');
            }
        }

        function togglePause() {
            if (isPaused) {
                // Resume recording
                mediaRecorder.resume();
                totalPausedTime += (new Date() - pauseStartTime);
                pauseBtn.innerHTML = '<i class="fas fa-pause"></i> Pause';
                pauseBtn.classList.remove('bg-gray-500');
                pauseBtn.classList.add('bg-yellow-500', 'hover:bg-yellow-600');
                startRecordingTimer();
            } else {
                // Pause recording
                mediaRecorder.pause();
                pauseStartTime = new Date();
                clearInterval(recordingTimer);
                pauseBtn.innerHTML = '<i class="fas fa-play"></i> Resume';
                pauseBtn.classList.remove('bg-yellow-500', 'hover:bg-yellow-600');
                pauseBtn.classList.add('bg-gray-500');
            }
            isPaused = !isPaused;
        }

        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
                clearInterval(recordingTimer);
                
                // Stop all tracks in the stream
                mediaRecorder.stream.getTracks().forEach(track => track.stop());
                
                recordBtn.disabled = false;
                pauseBtn.disabled = true;
                stopBtn.disabled = true;
                recordingIndicator.classList.add('hidden');
                
                recordBtn.classList.add('bg-red-500', 'hover:bg-red-600');
                recordBtn.classList.remove('bg-gray-400', 'cursor-not-allowed');
            }
        }

        function startRecordingTimer() {
            clearInterval(recordingTimer);
            recordingTimer = setInterval(() => {
                const elapsed = new Date() - recordingStartTime - totalPausedTime;
                const minutes = Math.floor(elapsed / 60000).toString().padStart(2, '0');
                const seconds = Math.floor((elapsed % 60000) / 1000).toString().padStart(2, '0');
                recordingTime.textContent = `${minutes}:${seconds}`;
            }, 1000);
        }

        function simulateTranscription(audioBlob) {
            // In a real app, you would send the audioBlob to a transcription API
            // For this demo, we'll simulate transcription with sample text
            
            processingIndicator.classList.remove('hidden');
            
            // Simulate API delay
            setTimeout(() => {
                // Sample transcription based on recording time
                const elapsed = new Date() - recordingStartTime - totalPausedTime;
                const wordCount = Math.floor(elapsed / 300); // Approx 200 words per minute
                
                transcription = generateSampleTranscription(wordCount);
                transcriptionText.value = transcription;
                
                // Now convert to business email
                convertToBusinessEmail();
                
                processingIndicator.classList.add('hidden');
                copyBtn.classList.remove('hidden');
            }, 2000);
        }

        function generateSampleTranscription(wordCount) {
            const samplePhrases = [
                "I wanted to follow up on our meeting yesterday",
                "Regarding the project timeline we discussed",
                "The quarterly results show significant improvement",
                "We should consider the new market opportunities",
                "The team has made excellent progress this month",
                "Let's schedule a call to review the proposal",
                "The client feedback was mostly positive",
                "We need to address the budget constraints",
                "The software update is scheduled for next week",
                "Please find attached the report for your review",
                "I recommend we proceed with the first option",
                "The deadline has been extended by two weeks",
                "Our competitors have launched a similar product",
                "The analytics dashboard needs some adjustments",
                "We've identified several key performance indicators",
                "The user testing revealed some usability issues",
                "The marketing campaign exceeded our expectations",
                "We should prioritize the customer experience improvements",
                "The technical team has resolved the major bugs",
                "Let me know if you need any additional information"
            ];
            
            // Add jargon terms if provided
            const jargonList = jargonTerms.value.split(',').filter(term => term.trim() !== '');
            if (jargonList.length > 0) {
                samplePhrases.push(...jargonList.map(term => `Regarding the ${term.trim()} implementation`));
            }
            
            let result = [];
            let wordsUsed = 0;
            
            while (wordsUsed < wordCount && samplePhrases.length > 0) {
                const randomIndex = Math.floor(Math.random() * samplePhrases.length);
                const phrase = samplePhrases[randomIndex];
                const phraseWordCount = phrase.split(' ').length;
                
                if (wordsUsed + phraseWordCount <= wordCount) {
                    result.push(phrase);
                    wordsUsed += phraseWordCount;
                } else {
                    // If we're close to the word count, just add a short phrase
                    const shortPhrase = samplePhrases.find(p => p.split(' ').length <= 3);
                    if (shortPhrase) {
                        result.push(shortPhrase);
                        wordsUsed += shortPhrase.split(' ').length;
                    }
                    break;
                }
            }
            
            return result.join('. ') + (result.length > 0 ? '.' : '');
        }

        function convertToBusinessEmail() {
            const selectedLanguage = languageSelect.value;
            const template = emailTemplates[selectedLanguage] || emailTemplates['en'];
            const creativity = parseInt(creativitySlider.value) / 100;
            
            // Get header and footer if provided
            const header = emailHeader.value.trim();
            const footer = emailFooter.value.trim();
            
            // Simulate AI processing with different creativity levels
            let emailBody;
            
            if (creativity < 0.3) {
                // Low creativity - very formal
                emailBody = `I hope this message finds you well. ${transcription} Please don't hesitate to reach out if you require any further clarification or assistance.`;
            } else if (creativity < 0.7) {
                // Medium creativity - balanced
                emailBody = `I'm reaching out regarding the following: ${transcription} Let me know your thoughts on this matter and if there's anything else you'd like to discuss.`;
            } else {
                // High creativity - more conversational
                emailBody = `I wanted to touch base with you about a few things. ${transcription} What do you think about these points? I'm open to suggestions and would love to hear your perspective.`;
            }
            
            // Construct the final email
            let finalEmail = '';
            
            if (header) {
                finalEmail += `${header}\n\n`;
            }
            
            finalEmail += `${template.greeting}\n\n${emailBody}\n\n${template.closing}`;
            
            if (footer) {
                finalEmail += `\n\n${footer}`;
            }
            
            transcriptionText.value = finalEmail;
        }

        function copyToClipboard() {
            transcriptionText.select();
            document.execCommand('copy');
            
            // Visual feedback
            const originalText = copyBtn.innerHTML;
            copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
            setTimeout(() => {
                copyBtn.innerHTML = originalText;
            }, 2000);
        }
    </script>
</body>
</html>
